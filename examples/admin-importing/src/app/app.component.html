<div style="text-align:left; font-weight: bold; font-size: 1.5em">
  @senzing/sdk-components-ng/examples/admin-importing
</div>
<div style="text-align:left; text-decoration: italic; font-size: 0.8em; margin: 2px 0 10px 0;">
  An example Angular app showing usage of the components and services only available
  when the <b>senzing-rest-api-server</b> is running in <b><i>admin mode</i></b>.
</div>

<div class="server-info">
  <div [class.active]="adminEnabled">Admin Enabled: {{adminEnabled}}</div>
  <div [class.active]="!readOnly">Read Only: {{readOnly}}</div>
</div>
<hr/>
<datalist #dataSourceOptions id="ds-name">
  <option *ngFor="let dataSource of dataSources" [value]="dataSource" (click)="handleDataSourceChange(dsa.dataSource,  dataSource)">{{dataSource}}</option>
</datalist>
<input #filePicker (change)="handleFileChange($event)" type="file"
       class="hidden-file-picker" accept=".JSON,.json,.csv,.CSV,.jsonl,.JSONL"
       xmlns="http://www.w3.org/1999/html">

<button mat-button (click)="handleFileClick($event)">Analyze File</button>

<table *ngIf="analysis" class="general-stats">
  <tr><th>Character Encoding:</th><td>{{ analysis.characterEncoding }}</td></tr>
  <tr><th>Media Type:</th><td>{{ analysis.mediaType }}</td></tr>
  <tr><th>Total Number of Records:</th><td>{{ analysis.recordCount }}</td></tr>
  <tr><th>Number of Records with Data Source:</th><td>{{ analysis.recordsWithDataSourceCount }}</td></tr>
  <tr><th>Number of Records with Record ID:</th><td>{{ analysis.recordsWithRecordIdCount }}</td></tr>
</table>


<table *ngIf="analysis" class="data-source-mapping">
  <tr>
    <th>Record Data Source</th>
    <th>Number of Records</th>
    <th>Records with Record ID</th>
    <th>Map to Data Source</th>
  </tr>
  <tr *ngFor="let dsa of analysis.analysisByDataSource">
    <td>{{ dsa.dataSource && dsa.dataSource.trim().length > 0 ? dsa.dataSource : '[NONE]' }}</td>
    <td>{{ dsa.recordCount }}</td>
    <td>{{ dsa.recordsWithRecordIdCount }}</td>
    <td class="data-source-map">
      <input type="text" placeholder="Choose a Data Source" matInput #targetDS
             [value]="dataSources.indexOf(dsa.dataSource) >= 0 ? dsa.dataSource : ''"
             list="ds-name"
             (change)="handleDataSourceChange(dsa.dataSource, targetDS.value)">
      <span *ngIf="targetDS.value && (targetDS.value.trim().length > 0) && (dataSources.indexOf(targetDS.value) < 0)">new</span>
    </td>
  </tr>
</table>

<br>
<button mat-button (click)="handleFileLoad($event)" *ngIf="analysis">Load File</button>

<table *ngIf="loadResult" class="general-stats">
  <tr><th>Character Encoding:</th><td>{{ loadResult.characterEncoding }}</td></tr>
  <tr><th>Media Type:</th><td>{{ loadResult.mediaType }}</td></tr>
  <tr><th>Total Number of Records:</th><td>{{ loadResult.recordCount }}</td></tr>
  <tr><th>Number of Loaded Records:</th><td>{{ loadResult.loadedRecordCount }}</td></tr>
  <tr><th>Number of Failed Records:</th><td>{{ loadResult.failedRecordCount }}</td></tr>
</table>

