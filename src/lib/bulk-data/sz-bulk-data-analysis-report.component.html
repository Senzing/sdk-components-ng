<!-- start BulkDataAnalysisReport -->
<table *ngIf="analysis && !currentError" class="data-source-mapping">
  <tr>
    <th>Record Data Source</th>
    <th>Number of Records</th>
    <th>Records with Record ID</th>
    <th>Map to Data Source</th>
  </tr>
  <tr *ngFor="let dsa of analysis.analysisByDataSource; let l = index;">
    <td>{{ dsa.dataSource && dsa.dataSource.trim().length > 0 ? dsa.dataSource : '[NONE]' }}</td>
    <td>{{ dsa.recordCount }}</td>
    <td>{{ dsa.recordsWithRecordIdCount }}</td>
    <td class="data-source-map">
      <input type="text" placeholder="Choose a Data Source" #targetDS
             [value]="dataSources.indexOf(dsa.dataSource) >= 0 ? dsa.dataSource : ''"
             [attr.list]="'ds-name-'+l"
             (change)="handleDataSourceChange(dsa.dataSource, targetDS.value)">
      <datalist #dataSourceOptions [id]="'ds-name-'+l">
        <option *ngFor="let dataSource of dataSources" [value]="dataSource" (click)="handleDataSourceChange(dsa.dataSource,  dataSource)">{{dataSource}}</option>
      </datalist>
      <span *ngIf="isNewDataDource( targetDS.value )">new</span>
    </td>
  </tr>
</table>
<!-- start BulkDataAnalysisReport -->
<!-- start entity type map table -->
<table *ngIf="analysis && !currentError" class="entity-type-mapping">
  <tr>
    <th>Record Entity Type</th>
    <th>Number of Records</th>
    <th>Records with Record ID</th>
    <!--<th>Map to Data Source</th>-->
    <th>Map to Entity Type</th>
  </tr>
  <tr *ngFor="let element of analysis.analysisByEntityType; let l = index;">
    <td>{{ element.entityType && element.entityType.trim().length > 0 ? element.entityType : '[NONE]' }}</td>
    <td>{{ element.recordCount }}</td>
    <td>{{ element.recordsWithRecordIdCount }}</td>
    <td class="entity-type-map">
      <input type="text" placeholder="Entity Type to map to" #targetET
      [value]="defaultIfUndefined(element.entityType,'GENERIC')"
      [attr.list]="getEntityTypeInputName(l)"
      (change)="handleEntityTypeChange(element.entityType, targetET.value)"
      class="example-full-width">
      <datalist #entityTypeOptions [id]="getEntityTypeInputName(l)">
        <option *ngFor="let eType of entityTypes" [value]="eType" (click)="handleEntityTypeChange(element.entityType,  eType)">{{eType}}</option>
      </datalist>
      <span *ngIf="isNewEntityType( targetET.value )">new</span>
    </td>
  </tr>
</table>
<!-- end entity type map table -->
